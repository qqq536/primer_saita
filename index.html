<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>By Guys</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>By Guys</h1>
        <nav>
            <a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a>
            <a href="admin.php">–ö–∞–±–∏–Ω–µ—Ç –∞–≤—Ç–æ—Ä–∞ –∫–æ–º–ø–∞–Ω–∏–∏ By Guys</a>
            <a href="—Å—á—ë—Ç—á–∏–∫.html">–°—á—ë—Ç—á–∏–∫ –¥–æ –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–≤</a>
            <a href="weather.html">–ü–æ–≥–æ–¥–∞</a>
            <a href="videos.html">–í–∏–¥–µ–æ</a>
            <a href="–æ –∫–æ–º–ø–∞–Ω–∏–∏ –∏ –ø—Ä–æ–µ–∫—Ç–µ.html">–û –∫–æ–º–ø–∞–Ω–∏–∏ –∏ –ø—Ä–æ–µ–∫—Ç–µ</a>
        </nav>
    </header>

    <main>
        <div id="news-container">
            <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</div>
        </div>
    </main>

    <script>
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–æ–≤–æ—Å—Ç–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    function loadNews() {
        fetch('get-news.php')
            .then(response => response.json())
            .then(news => {
                const container = document.getElementById('news-container');
                container.innerHTML = '';
                
                if (news.length === 0) {
                    container.innerHTML = '<p class="no-news">–ü–æ–∫–∞ –Ω–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –ò–≥—Ä–∞ —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è!</p>';
                    return;
                }
                
                if (news.error) {
                    container.innerHTML = '<p class="error">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</p>';
                    return;
                }
                
                news.forEach(item => {
    let mediaHtml = '';
    if (item.media_url) {
        switch(item.media_type) {
            case 'image':
                mediaHtml = `<div class="news-media"><img src="${item.media_url}" alt="${item.title}" style="max-width: 100%; border-radius: 5px;"></div>`;
                break;
            case 'video':
                mediaHtml = `<div class="news-media"><video src="${item.media_url}" controls style="max-width: 100%; border-radius: 5px;"></video></div>`;
                break;
            case 'audio':
                mediaHtml = `<div class="news-media"><audio src="${item.media_url}" controls style="width: 100%;"></audio></div>`;
                break;
        }
    }
    
    const newsItem = `
        <article class="news-item">
            <h2>${item.title}</h2>
            <div class="news-meta">
                <span class="author">üë§ ${item.author}</span>
                <span class="date">üìÖ ${item.created_at}</span>
            </div>
            ${mediaHtml}
            <div class="news-content">${item.content}</div>
        </article>
    `;
    container.innerHTML += newsItem;
});
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞:', error);
                document.getElementById('news-container').innerHTML = 
                    '<p class="error">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–æ–≤–æ—Å—Ç–µ–π. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ.</p>';
            });
    }

    // –§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è –Ω–æ–≤–æ—Å—Ç–∏
    function deleteNews(id) {
        if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –Ω–æ–≤–æ—Å—Ç—å?')) {
            return;
        }
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ
        fetch('delete-news.php', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: 'id=' + id
        })
        .then(response => response.json())
        .then(result => {
            if (result.success) {
                alert('–ù–æ–≤–æ—Å—Ç—å —É–¥–∞–ª–µ–Ω–∞!');
                loadNews(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ –Ω–æ–≤–æ—Å—Ç–µ–π
            } else {
                alert('–û—à–∏–±–∫–∞: ' + result.error);
            }
        })
        .catch(error => {
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏: ' + error);
        });
    }

    // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–æ–≤–æ—Å—Ç–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
    loadNews();
</script>
</body>

</html>
